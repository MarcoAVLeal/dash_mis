library(zoo)
library(forecast)
library(GGally)
cores <- c(RColorBrewer::brewer.pal(9,name = "Set1"),RColorBrewer::brewer.pal(8,name = "Dark2"))
cores <- cores[-c(4,1)]
knitr::opts_chunk$set(echo = TRUE,warning= FALSE, message= FALSE,
out.width = "100%",fig.align = "center",size ="large",fig.height = 3.5)
color_pal = c(RColorBrewer::brewer.pal(n = 8,name = "Dark2")[c(2,3,5,6,7,8,9)],
RColorBrewer::brewer.pal(n = 8,name = "Set1"),
RColorBrewer::brewer.pal(n = 8,name = "Set2"))
df <- read.csv(file = "D:\\OneDrive - Crefaz Financiamentos e Investimentos\\dash_mis_dados\\motor\\motor-agregadado.csv")
df$DATACADASTRO <- lubridate::as_date(df$DATACADASTRO)
df$DATA_PAGAMENTO <- lubridate::as_date(df$DATA_PAGAMENTO)
df$ANO_CADASTRO <- lubridate::year(df$DATACADASTRO)
df$ANO_PAGAMENTO <- lubridate::year(df$DATA_PAGAMENTO)
df$MES_CADASTRO <- lubridate::month(df$DATACADASTRO)
df$MES_PAGAMENTO <- lubridate::month(df$DATA_PAGAMENTO)
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")
n = nrow(df_pago)
pos_na <- is.na(df_pago$DATA_PAGAMENTO ) %>% which
df_pago[pos_na,"DATA_PAGAMENTO"] <- df_pago[pos_na,"DATACADASTRO"]
df_pago$DATA_PAGAMENTO %>% range
as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
library(zoo)
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
reservados   <- df_pago %>% dplyr::filter(DATA_PAGAMENTO > f_data)
df_pago      <- df_pago %>% dplyr::filter(DATA_PAGAMENTO <= f_data)
df_pago$DATA_PAGAMENTO %>% range
reservados$DATA_PAGAMENTO %>% range
df_pago  %>% dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas))
producao_df <- df_pago %>%  dplyr::group_by(DATA_PAGAMENTO) %>% dplyr::summarise(Producao = sum(VLR_PRODUCAO),
Qntd     =sum(Qntd_Propostas)) %>% dplyr::select(DATA_PAGAMENTO,Producao)
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))
df_1
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES")) %>% complete.cases
df_1
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES")) %>% complete.cases
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))
df_1
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))  %>% tidyr::complete
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))  %>% tidyr::complete(ANOMES)
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))  %>% tidyr::complete(ANOMES)
df_1
df_res <- reservados %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_res$ANOMES <- as.Date(paste(df_res$ANOMES,"-01",sep=""))
df_res      <- df_res %>% dplyr::select(c("Producao","ANOMES"))
df_res
source(file = "funcoes.R",encoding = "UTF-8")
library(tidyverse)
library(knitr)
library(kableExtra)
library(caret)
library(ggplot2)
library(MLmetrics)
library(klaR)
library(plotROC)
library(RColorBrewer)
library(zoo)
library(forecast)
library(GGally)
cores <- c(RColorBrewer::brewer.pal(9,name = "Set1"),RColorBrewer::brewer.pal(8,name = "Dark2"))
cores <- cores[-c(4,1)]
knitr::opts_chunk$set(echo = TRUE,warning= FALSE, message= FALSE,
out.width = "100%",fig.align = "center",size ="large",fig.height = 3.5)
color_pal = c(RColorBrewer::brewer.pal(n = 8,name = "Dark2")[c(2,3,5,6,7,8,9)],
RColorBrewer::brewer.pal(n = 8,name = "Set1"),
RColorBrewer::brewer.pal(n = 8,name = "Set2"))
df <- read.csv(file = "D:\\OneDrive - Crefaz Financiamentos e Investimentos\\dash_mis_dados\\motor\\motor-agregadado.csv")
df$DATACADASTRO <- lubridate::as_date(df$DATACADASTRO)
df$DATA_PAGAMENTO <- lubridate::as_date(df$DATA_PAGAMENTO)
df$ANO_CADASTRO <- lubridate::year(df$DATACADASTRO)
df$ANO_PAGAMENTO <- lubridate::year(df$DATA_PAGAMENTO)
df$MES_CADASTRO <- lubridate::month(df$DATACADASTRO)
df$MES_PAGAMENTO <- lubridate::month(df$DATA_PAGAMENTO)
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")
n = nrow(df_pago)
pos_na <- is.na(df_pago$DATA_PAGAMENTO ) %>% which
df_pago[pos_na,"DATA_PAGAMENTO"] <- df_pago[pos_na,"DATACADASTRO"]
df_pago$DATA_PAGAMENTO %>% range
as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
library(zoo)
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
f_data
lubridate::ym(f_data)
ubridate::ym(f_data)
lubridate::ym(f_data)
format(f_data,"%Y-%m")
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
f_data <- as.Date(paste(format(f_data,"%Y-%m"),"-01",sep=""))
source(file = "funcoes.R",encoding = "UTF-8")
library(tidyverse)
library(knitr)
library(kableExtra)
library(caret)
library(ggplot2)
library(MLmetrics)
library(klaR)
library(plotROC)
library(RColorBrewer)
library(zoo)
library(forecast)
library(GGally)
cores <- c(RColorBrewer::brewer.pal(9,name = "Set1"),RColorBrewer::brewer.pal(8,name = "Dark2"))
cores <- cores[-c(4,1)]
knitr::opts_chunk$set(echo = TRUE,warning= FALSE, message= FALSE,
out.width = "100%",fig.align = "center",size ="large",fig.height = 3.5)
color_pal = c(RColorBrewer::brewer.pal(n = 8,name = "Dark2")[c(2,3,5,6,7,8,9)],
RColorBrewer::brewer.pal(n = 8,name = "Set1"),
RColorBrewer::brewer.pal(n = 8,name = "Set2"))
df <- read.csv(file = "D:\\OneDrive - Crefaz Financiamentos e Investimentos\\dash_mis_dados\\motor\\motor-agregadado.csv")
df$DATACADASTRO <- lubridate::as_date(df$DATACADASTRO)
df$DATA_PAGAMENTO <- lubridate::as_date(df$DATA_PAGAMENTO)
df$ANO_CADASTRO <- lubridate::year(df$DATACADASTRO)
df$ANO_PAGAMENTO <- lubridate::year(df$DATA_PAGAMENTO)
df$MES_CADASTRO <- lubridate::month(df$DATACADASTRO)
df$MES_PAGAMENTO <- lubridate::month(df$DATA_PAGAMENTO)
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")
n = nrow(df_pago)
pos_na <- is.na(df_pago$DATA_PAGAMENTO ) %>% which
df_pago[pos_na,"DATA_PAGAMENTO"] <- df_pago[pos_na,"DATACADASTRO"]
df_pago$DATA_PAGAMENTO %>% range
as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
library(zoo)
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
f_data <- as.Date(paste(format(f_data,"%Y-%m"),"-01",sep=""))
reservados   <- df_pago %>% dplyr::filter(lubridate::ym(DATA_PAGAMENTO) > lubridate::ym(f_data))
df_pago      <- df_pago %>% dplyr::filter(DATA_PAGAMENTO <= f_data)
df_pago$DATA_PAGAMENTO %>% range
reservados$DATA_PAGAMENTO %>% range
reservados   <- df_pago %>% dplyr::filter(DATA_PAGAMENTO > f_data)
reservados
source(file = "funcoes.R",encoding = "UTF-8")
library(tidyverse)
library(knitr)
library(kableExtra)
library(caret)
library(ggplot2)
library(MLmetrics)
library(klaR)
library(plotROC)
library(RColorBrewer)
library(zoo)
library(forecast)
library(GGally)
cores <- c(RColorBrewer::brewer.pal(9,name = "Set1"),RColorBrewer::brewer.pal(8,name = "Dark2"))
cores <- cores[-c(4,1)]
knitr::opts_chunk$set(echo = TRUE,warning= FALSE, message= FALSE,
out.width = "100%",fig.align = "center",size ="large",fig.height = 3.5)
color_pal = c(RColorBrewer::brewer.pal(n = 8,name = "Dark2")[c(2,3,5,6,7,8,9)],
RColorBrewer::brewer.pal(n = 8,name = "Set1"),
RColorBrewer::brewer.pal(n = 8,name = "Set2"))
df <- read.csv(file = "D:\\OneDrive - Crefaz Financiamentos e Investimentos\\dash_mis_dados\\motor\\motor-agregadado.csv")
df$DATACADASTRO <- lubridate::as_date(df$DATACADASTRO)
df$DATA_PAGAMENTO <- lubridate::as_date(df$DATA_PAGAMENTO)
df$ANO_CADASTRO <- lubridate::year(df$DATACADASTRO)
df$ANO_PAGAMENTO <- lubridate::year(df$DATA_PAGAMENTO)
df$MES_CADASTRO <- lubridate::month(df$DATACADASTRO)
df$MES_PAGAMENTO <- lubridate::month(df$DATA_PAGAMENTO)
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")
n = nrow(df_pago)
pos_na <- is.na(df_pago$DATA_PAGAMENTO ) %>% which
df_pago[pos_na,"DATA_PAGAMENTO"] <- df_pago[pos_na,"DATACADASTRO"]
df_pago$DATA_PAGAMENTO %>% range
as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
library(zoo)
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
f_data <- as.Date(paste(format(f_data,"%Y-%m"),"-01",sep=""))
reservados   <- df_pago %>% dplyr::filter(DATA_PAGAMENTO > f_data)
df_pago      <- df_pago %>% dplyr::filter(DATA_PAGAMENTO <= f_data)
source(file = "funcoes.R",encoding = "UTF-8")
library(tidyverse)
library(knitr)
library(kableExtra)
library(caret)
library(ggplot2)
library(MLmetrics)
library(klaR)
library(plotROC)
library(RColorBrewer)
library(zoo)
library(forecast)
library(GGally)
cores <- c(RColorBrewer::brewer.pal(9,name = "Set1"),RColorBrewer::brewer.pal(8,name = "Dark2"))
cores <- cores[-c(4,1)]
knitr::opts_chunk$set(echo = TRUE,warning= FALSE, message= FALSE,
out.width = "100%",fig.align = "center",size ="large",fig.height = 3.5)
color_pal = c(RColorBrewer::brewer.pal(n = 8,name = "Dark2")[c(2,3,5,6,7,8,9)],
RColorBrewer::brewer.pal(n = 8,name = "Set1"),
RColorBrewer::brewer.pal(n = 8,name = "Set2"))
df <- read.csv(file = "D:\\OneDrive - Crefaz Financiamentos e Investimentos\\dash_mis_dados\\motor\\motor-agregadado.csv")
df$DATACADASTRO <- lubridate::as_date(df$DATACADASTRO)
df$DATA_PAGAMENTO <- lubridate::as_date(df$DATA_PAGAMENTO)
df$ANO_CADASTRO <- lubridate::year(df$DATACADASTRO)
df$ANO_PAGAMENTO <- lubridate::year(df$DATA_PAGAMENTO)
df$MES_CADASTRO <- lubridate::month(df$DATACADASTRO)
df$MES_PAGAMENTO <- lubridate::month(df$DATA_PAGAMENTO)
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")
n = nrow(df_pago)
pos_na <- is.na(df_pago$DATA_PAGAMENTO ) %>% which
df_pago[pos_na,"DATA_PAGAMENTO"] <- df_pago[pos_na,"DATACADASTRO"]
df_pago$DATA_PAGAMENTO %>% range
as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
library(zoo)
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
f_data <- as.Date(paste(format(f_data,"%Y-%m"),"-01",sep=""))
reservados   <- df_pago %>% dplyr::filter(DATA_PAGAMENTO >= f_data)
df_pago      <- df_pago %>% dplyr::filter(DATA_PAGAMENTO < f_data)
df_pago$DATA_PAGAMENTO %>% range
reservados$DATA_PAGAMENTO %>% range
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))  %>% tidyr::complete(ANOMES)
df_1
df_res <- reservados %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_res$ANOMES <- as.Date(paste(df_res$ANOMES,"-01",sep=""))
df_res      <- df_res %>% dplyr::select(c("Producao","ANOMES"))
producao_st   <- ts(data = df_1$Producao,frequency = 12,start = c(2017))
producao_st
source(file = "funcoes.R",encoding = "UTF-8")
library(tidyverse)
library(knitr)
library(kableExtra)
library(caret)
library(ggplot2)
library(MLmetrics)
library(klaR)
library(plotROC)
library(RColorBrewer)
library(zoo)
library(forecast)
library(GGally)
cores <- c(RColorBrewer::brewer.pal(9,name = "Set1"),RColorBrewer::brewer.pal(8,name = "Dark2"))
cores <- cores[-c(4,1)]
knitr::opts_chunk$set(echo = TRUE,warning= FALSE, message= FALSE,
out.width = "100%",fig.align = "center",size ="large",fig.height = 3.5)
color_pal = c(RColorBrewer::brewer.pal(n = 8,name = "Dark2")[c(2,3,5,6,7,8,9)],
RColorBrewer::brewer.pal(n = 8,name = "Set1"),
RColorBrewer::brewer.pal(n = 8,name = "Set2"))
df <- read.csv(file = "D:\\OneDrive - Crefaz Financiamentos e Investimentos\\dash_mis_dados\\motor\\motor-agregadado.csv")
df$DATACADASTRO <- lubridate::as_date(df$DATACADASTRO)
df$DATA_PAGAMENTO <- lubridate::as_date(df$DATA_PAGAMENTO)
df$ANO_CADASTRO <- lubridate::year(df$DATACADASTRO)
df$ANO_PAGAMENTO <- lubridate::year(df$DATA_PAGAMENTO)
df$MES_CADASTRO <- lubridate::month(df$DATACADASTRO)
df$MES_PAGAMENTO <- lubridate::month(df$DATA_PAGAMENTO)
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")
n = nrow(df_pago)
pos_na <- is.na(df_pago$DATA_PAGAMENTO ) %>% which
df_pago[pos_na,"DATA_PAGAMENTO"] <- df_pago[pos_na,"DATACADASTRO"]
df_pago$DATA_PAGAMENTO %>% range
as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
library(zoo)
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
f_data <- as.Date(paste(format(f_data,"%Y-%m"),"-01",sep=""))
reservados   <- df_pago %>% dplyr::filter(DATA_PAGAMENTO >= f_data)
df_pago      <- df_pago %>% dplyr::filter(DATA_PAGAMENTO < f_data)
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))  %>% tidyr::complete(ANOMES)
df_1
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")  %>% dplyr::filter(DATA_PAGAMENTO > "2018-01-01")
source(file = "funcoes.R",encoding = "UTF-8")
library(tidyverse)
library(knitr)
library(kableExtra)
library(caret)
library(ggplot2)
library(MLmetrics)
library(klaR)
library(plotROC)
library(RColorBrewer)
library(zoo)
library(forecast)
library(GGally)
cores <- c(RColorBrewer::brewer.pal(9,name = "Set1"),RColorBrewer::brewer.pal(8,name = "Dark2"))
cores <- cores[-c(4,1)]
knitr::opts_chunk$set(echo = TRUE,warning= FALSE, message= FALSE,
out.width = "100%",fig.align = "center",size ="large",fig.height = 3.5)
color_pal = c(RColorBrewer::brewer.pal(n = 8,name = "Dark2")[c(2,3,5,6,7,8,9)],
RColorBrewer::brewer.pal(n = 8,name = "Set1"),
RColorBrewer::brewer.pal(n = 8,name = "Set2"))
df <- read.csv(file = "D:\\OneDrive - Crefaz Financiamentos e Investimentos\\dash_mis_dados\\motor\\motor-agregadado.csv")
df$DATACADASTRO <- lubridate::as_date(df$DATACADASTRO)
df$DATA_PAGAMENTO <- lubridate::as_date(df$DATA_PAGAMENTO)
df$ANO_CADASTRO <- lubridate::year(df$DATACADASTRO)
df$ANO_PAGAMENTO <- lubridate::year(df$DATA_PAGAMENTO)
df$MES_CADASTRO <- lubridate::month(df$DATACADASTRO)
df$MES_PAGAMENTO <- lubridate::month(df$DATA_PAGAMENTO)
df_pago <- df %>% dplyr::filter(STATUS_PRINCIPAL == "PAGO AO CLIENTE")  %>% dplyr::filter(DATA_PAGAMENTO > "2018-01-01")
n = nrow(df_pago)
pos_na <- is.na(df_pago$DATA_PAGAMENTO ) %>% which
df_pago[pos_na,"DATA_PAGAMENTO"] <- df_pago[pos_na,"DATACADASTRO"]
df_pago$DATA_PAGAMENTO %>% range
as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
library(zoo)
f_data <- as.Date(max(df_pago$DATA_PAGAMENTO,na.rm = TRUE)) - 180
f_data <- as.Date(paste(format(f_data,"%Y-%m"),"-01",sep=""))
reservados   <- df_pago %>% dplyr::filter(DATA_PAGAMENTO >= f_data)
df_pago      <- df_pago %>% dplyr::filter(DATA_PAGAMENTO < f_data)
df_pago$DATA_PAGAMENTO %>% range
reservados$DATA_PAGAMENTO %>% range
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))  %>% tidyr::complete(ANOMES)
df_res <- reservados %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_res$ANOMES <- as.Date(paste(df_res$ANOMES,"-01",sep=""))
df_res      <- df_res %>% dplyr::select(c("Producao","ANOMES"))
df_res
df_1
producao_st   <- ts(data = df_1$Producao,frequency = 12,start = c(2018))
df_1$ANOMES %>% range
#producao           <- zoo(log(producao_df$Producao)  ,producao_df$DATA_PAGAMENTO)
Producao_Holt      = holt(producao_st,level = .95,h = 8)
#producao           <- zoo(log(producao_df$Producao)  ,producao_df$DATA_PAGAMENTO)
Producao_Holt      = holt(producao_st,level = .95,h = 7)
Producao_SES       = ses(producao_st,level = .95,h = 7)
fit.auto           = auto.arima(producao_st)
fit.auto$fitted
metrics_names = c("$\\hat{x}_{t}(1)$","$\\hat{x}_{t}(2)$","$\\hat{x}_{t}(3)$","$\\hat{x}_{t}(4)$","$\\hat{x}_{t}(5)$","$\\hat{x}_{t}(6)$")
rnames <- c("SE de Holt" , "Auto","Original")
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_Holt$mean),
X2 = as.vector(predict(fitauto,n.ahead = 8)$pred),
Original = df_res$Producao
)),row.names = rnames)
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_Holt$mean),
X2 = as.vector(predict(fitauto,n.ahead = 7)$pred),
Original = df_res$Producao
)),row.names = rnames)
df_pago$DATA_PAGAMENTO %>% range
producao_df <- df_1 %>% mutate(`Ajuste Holt(Producao)`     = Producao_Holt$fitted,
`Ajuste SES(Producao)`      = Producao_SES$fitted)
df1 <- data.frame(Data = c(df_1$ANOMES,df_res$ANOMES),
Producao = c(df_1$Producao,df_res$Producao),
`Ajuste Holt(Producao)`     = c(Producao_Holt$fitted,Producao_Holt$mean),
`Ajuste SES(Producao)`      = c(Producao_SES$fitted,Producao_SES$mean),
`Auto Arima`                = c(fitauto$fitted,predict(fitauto,n.ahead = 8)$pred)) %>%
dplyr::rename(`Ajuste Holt(Diesel)` = Ajuste.Holt.Producao.,
`Ajuste SES(Diesel)` = Ajuste.SES.Producao.,
`Auto Arima`   =  `Auto.Arima`)
df1 <- data.frame(Data = c(df_1$ANOMES,df_res$ANOMES),
Producao = c(df_1$Producao,df_res$Producao),
`Ajuste Holt(Producao)`     = c(Producao_Holt$fitted,Producao_Holt$mean),
`Ajuste SES(Producao)`      = c(Producao_SES$fitted,Producao_SES$mean),
`Auto Arima`                = c(fitauto$fitted,predict(fitauto,n.ahead = 7)$pred)) %>%
dplyr::rename(`Ajuste Holt(Diesel)` = Ajuste.Holt.Producao.,
`Ajuste SES(Diesel)` = Ajuste.SES.Producao.,
`Auto Arima`   =  `Auto.Arima`)
data_res
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_SES$mean),
X2 = as.vector(Producao_Holt$mean),
X3 = as.vector(predict(fitauto,n.ahead = 7)$pred),
Original = df_res$Producao
)),row.names = rnames)
data_res
df1 <- data.frame(Data = c(df_1$ANOMES,df_res$ANOMES),
Producao = c(df_1$Producao,df_res$Producao),
`Ajuste Holt(Producao)`     = c(Producao_Holt$fitted,Producao_Holt$mean),
`Ajuste SES(Producao)`      = c(Producao_SES$fitted,Producao_SES$mean),
`Auto Arima`                = c(fitauto$fitted,predict(fitauto,n.ahead = 7)$pred)) %>%
dplyr::rename(`Ajuste Holt(Diesel)` = Ajuste.Holt.Producao.,
`Ajuste SES(Diesel)` = Ajuste.SES.Producao.,
`Auto Arima`   =  `Auto.Arima`)
c(df_1$ANOMES,df_res$ANOMES)
c(df_1$Producao,df_res$Producao)
c(Producao_Holt$fitted,Producao_Holt$mean)
c(Producao_SES$fitted,Producao_SES$mean)
c(fitauto$fitted,predict(fitauto,n.ahead = 7)$pred)
fit.auto           = auto.arima(producao_st)
fit.auto$fitted
#producao           <- zoo(log(producao_df$Producao)  ,producao_df$DATA_PAGAMENTO)
Producao_Holt      = holt(producao_st,level = .95,h = 7)
Producao_SES       = ses(producao_st,level = .95,h = 7)
fit.auto           = auto.arima(producao_st)
fit.auto$fitted
metrics_names = c("$\\hat{x}_{t}(1)$","$\\hat{x}_{t}(2)$","$\\hat{x}_{t}(3)$","$\\hat{x}_{t}(4)$","$\\hat{x}_{t}(5)$","$\\hat{x}_{t}(6)$")
rnames <- c("SE Simples", "SE de Holt" , "Auto","Original")
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_SES$mean),
X2 = as.vector(Producao_Holt$mean),
X3 = as.vector(predict(fitauto,n.ahead = 7)$pred),
Original = df_res$Producao
)),row.names = rnames)
df1 <- data.frame(Data = c(df_1$ANOMES,df_res$ANOMES),
Producao = c(df_1$Producao,df_res$Producao),
`Ajuste Holt(Producao)`     = c(Producao_Holt$fitted,Producao_Holt$mean),
`Ajuste SES(Producao)`      = c(Producao_SES$fitted,Producao_SES$mean),
`Auto Arima`                = c(fitauto$fitted,predict(fitauto,n.ahead = 7)$pred)) %>%
dplyr::rename(`Ajuste Holt(Diesel)` = Ajuste.Holt.Producao.,
`Ajuste SES(Diesel)` = Ajuste.SES.Producao.,
`Auto Arima`   =  `Auto.Arima`)
fitauto$fitted
df1 <- data.frame(Data = c(df_1$ANOMES,df_res$ANOMES),
Producao = c(df_1$Producao,df_res$Producao),
`Ajuste Holt(Producao)`     = c(Producao_Holt$fitted,Producao_Holt$mean),
`Ajuste SES(Producao)`      = c(Producao_SES$fitted,Producao_SES$mean),
`Auto Arima`                = c(fit.auto$fitted,predict(fit.auto,n.ahead = 7)$pred)) %>%
dplyr::rename(`Ajuste Holt(Diesel)` = Ajuste.Holt.Producao.,
`Ajuste SES(Diesel)` = Ajuste.SES.Producao.,
`Auto Arima`   =  `Auto.Arima`)
fit.auto$fitted
predict(fit.auto,n.ahead = 7)$pred)
predict(fit.auto,n.ahead = 7)$pred))
predict(fit.auto,n.ahead = 7)$pred
df1 <- data.frame(Data = c(df_1$ANOMES,df_res$ANOMES),
Producao = c(df_1$Producao,df_res$Producao),
`Ajuste Holt(Producao)`     = c(Producao_Holt$fitted,Producao_Holt$mean),
`Ajuste SES(Producao)`      = c(Producao_SES$fitted,Producao_SES$mean),
`Auto Arima`                = c(fit.auto$fitted,predict(fit.auto,n.ahead = 6)$pred)) %>%
dplyr::rename(`Ajuste Holt(Diesel)` = Ajuste.Holt.Producao.,
`Ajuste SES(Diesel)` = Ajuste.SES.Producao.,
`Auto Arima`   =  `Auto.Arima`)
df1 <- data.frame(Data = c(df_1$ANOMES,df_res$ANOMES),
Producao = c(df_1$Producao,df_res$Producao),
`Ajuste Holt(Producao)`     = c(Producao_Holt$fitted,Producao_Holt$mean),
`Ajuste SES(Producao)`      = c(Producao_SES$fitted,Producao_SES$mean),
`Auto Arima`                = c(fit.auto$fitted,predict(fit.auto,n.ahead = 7)$pred)) %>%
dplyr::rename(`Ajuste Holt(Diesel)` = Ajuste.Holt.Producao.,
`Ajuste SES(Diesel)` = Ajuste.SES.Producao.,
`Auto Arima`   =  `Auto.Arima`)
fit.auto
fit.auto,n.ahead = 7)$pred
library(aTSA)
library(fpp2)
fit.auto
predict(fitauto,n.ahead = 7)$pred
df_1 <- df_pago %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_1$ANOMES <- as.Date(paste(df_1$ANOMES,"-01",sep=""))
df_1      <- df_1 %>% dplyr::select(c("Producao","ANOMES"))  %>% tidyr::complete(ANOMES)
df_res <- reservados %>%  dplyr::group_by(ANO_PAGAMENTO,MES_PAGAMENTO) %>%
dplyr::summarise(Producao = sum(VLR_PRODUCAO),Qntd     =sum(Qntd_Propostas)) %>%
dplyr::select(ANO_PAGAMENTO,MES_PAGAMENTO,Producao) %>% dplyr::mutate(ANOMES = paste0(ANO_PAGAMENTO,"-",MES_PAGAMENTO)) %>% as.data.frame
df_res$ANOMES <- as.Date(paste(df_res$ANOMES,"-01",sep=""))
df_res      <- df_res %>% dplyr::select(c("Producao","ANOMES"))
producao_st   <- ts(data = df_1$Producao,frequency = 12,start = c(2018))
producao_st
#producao           <- zoo(log(producao_df$Producao)  ,producao_df$DATA_PAGAMENTO)
Producao_Holt      = holt(producao_st,level = .95,h = 7)
Producao_SES       = ses(producao_st,level = .95,h = 7)
fit.auto           = auto.arima(producao_st)
fit.auto
metrics_names = c("$\\hat{x}_{t}(1)$","$\\hat{x}_{t}(2)$","$\\hat{x}_{t}(3)$","$\\hat{x}_{t}(4)$","$\\hat{x}_{t}(5)$","$\\hat{x}_{t}(6)$")
rnames <- c("SE Simples", "SE de Holt" , "Auto","Original")
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_SES$mean),
X2 = as.vector(Producao_Holt$mean),
X3 = as.vector(predict(fit.auto,n.ahead = 7)$pred),
Original = df_res$Producao
)),row.names = rnames)
auto           = auto.arima(producao_st)
auto$fitted
metrics_names = c("$\\hat{x}_{t}(1)$","$\\hat{x}_{t}(2)$","$\\hat{x}_{t}(3)$","$\\hat{x}_{t}(4)$","$\\hat{x}_{t}(5)$","$\\hat{x}_{t}(6)$")
rnames <- c("SE Simples", "SE de Holt" , "Auto","Original")
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_SES$mean),
X2 = as.vector(Producao_Holt$mean),
X3 = as.vector(predict(auto,n.ahead = 7)$pred),
Original = df_res$Producao
)),row.names = rnames)
forecast(auto)
auto           = Arima(producao_st,order = c(1,1,1))
forecast(auto)
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_SES$mean),
X2 = as.vector(Producao_Holt$mean),
X3 = as.vector(predict(auto,n.ahead = 7)$pred),
Original = df_res$Producao
)),row.names = rnames)
data_res
auto           = Arima(producao_st,order = c(0,1,0))
forecast(auto)
metrics_names = c("$\\hat{x}_{t}(1)$","$\\hat{x}_{t}(2)$","$\\hat{x}_{t}(3)$","$\\hat{x}_{t}(4)$","$\\hat{x}_{t}(5)$","$\\hat{x}_{t}(6)$")
rnames <- c("SE Simples", "SE de Holt" , "Auto","Original")
data_res <- as.data.frame(t(cbind(
X1 = as.vector(Producao_SES$mean),
X2 = as.vector(Producao_Holt$mean),
X3 = as.vector(predict(auto,n.ahead = 7)$pred),
Original = df_res$Producao
)),row.names = rnames)
data_res
