shiny::runApp()
source(file = "librarys.R")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
x <- read.csv(file = 'dados\\2022_02.csv')
x
x["Total","total"]
shinydashboard::valueBox(subtitle = NULL,value = x[1,"total"],
width = 12,icon = tags$i(class = "fas fa-phone", style="font-size: 80px"), color = "blue")
x[1,"total"]
runApp()
runApp()
runApp()
x
runApp()
runApp()
x
runApp()
runApp()
runApp()
runApp()
x
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
library(rainy)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
espaco_html <<- function(n=6){
return(HTML( rep("<br>",n)))
}
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
source(file = "pagina1.R",encoding = "utf-8")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
x <- read.csv(file = 'https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/Ea1IGOUCSa1Mjlev_QvrNLAB4I_qcKHjWy908-RxDbWPcQ?e=UOIBCd/2022_02.csv')
x
x <- read.csv(file = 'https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/Ea1IGOUCSa1Mjlev_QvrNLAB4I_qcKHjWy908-RxDbWPcQ?e=UOIBCd')
x
read_url_csv <- function(url, ...){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- readr::read_csv(tmpFile, ...)
return(url_csv)
}
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/Ea1IGOUCSa1Mjlev_QvrNLAB4I_qcKHjWy908-RxDbWPcQ?e=UOIBCd"
csv <- read_url_csv(onedrive_url)
csv
runApp()
read_url_csv <- function(url, ...){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- readr::read_csv(tmpFile, ...)
return(url_csv)
}
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/Ea1IGOUCSa1Mjlev_QvrNLAB4I_qcKHjWy908-RxDbWPcQ?download=1"
csv <- read_url_csv(onedrive_url)
csv
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(shinycssloaders)
runApp()
runApp()
runApp()
runApp()
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ESjlRAy5mzVJh3LRucNvoTYBa5x7ReX2691dJ-5uwaob4w?download=1"
df <- read_url_csv(onedrive_url)
users             <- read.csv(file = paste0(path_dados,"users.xls.csv"),sep = ";")
users$ID          <- as.character(users$ID)
regionais         <- read_xlsx(path = paste0(path_dados,"regionais.xlsx"),sheet = "Planilha1")
df                <- left_join(x = df,y = users,by=c("Pessoa reponsavel ID"="ID"),keep=TRUE,suffix = c("_LEADS","_users"))
read_url_xlsx <- function(url,sheet = "Calendario"){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- read_xlsx(tmpFile, ...)
return(url_csv)
}
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EbsSsZPj4ntMvyRUG-0QYa4BTEQUCw8VXlCqTriyMQcYiw?download=1"
calendario <- read_url_xlsx(onedrive_url,sheet = "Calendario")
calendario
read_url_xlsx <- function(url,sheet = "Calendario"){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- read_xlsx(tmpFile,sheet = sheet)
return(url_csv)
}
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EbsSsZPj4ntMvyRUG-0QYa4BTEQUCw8VXlCqTriyMQcYiw?download=1"
calendario <- read_url_xlsx(onedrive_url,sheet = "Calendario")
calendario
read_url_xlsx <- function(url,sheet = "Calendario"){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- read_xlsx(path = tmpFile,sheet = sheet)
return(url_csv)
}
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EbsSsZPj4ntMvyRUG-0QYa4BTEQUCw8VXlCqTriyMQcYiw?download=1"
calendario <- read_url_xlsx(onedrive_url,sheet = "Calendario")
library(readxl)
url <- "https://ikl9pg.sn.files.1drv.com/y4mu_0J_zDuyU56LBAPlT4-ASQWsN3SqQ9OobV_8w0cFyy3XZCStCeGBxfCjzx9I2uVzQDrIfUG0p6m4eOe9vzzOMlamV3mccjstEYFXVo78bRvwW0k1nRVIJEkmN60rCSpya41L6IMcrZ4YhXWzFXS9w/Richard_Sprague_Tracking.xlsx?download&psid=1"
destfile <- "calendario.xlsx"
curl::curl_download(url, destfile)
calendario <- read_excel(destfile)
onedrive_url <-
#calendario <- read_url_xlsx(onedrive_url,sheet = "Calendario")
library(readxl)
url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EbsSsZPj4ntMvyRUG-0QYa4BTEQUCw8VXlCqTriyMQcYiw?download=1"
destfile <- "calendario.xlsx"
curl::curl_download(url, destfile)
calendario <- read_excel(destfile)
head(Richard_Sprague_Tracking)
head(calendario)
calendario <- read_excel(destfile,sheet = "Calendario")
head(calendario)
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ES9Opw7qVkROh6yxmaC8ARQB1_RuzanE2l8fl3U7p6r4KQ?download=1"
users             <- read_url_csv(onedrive_url)
users$ID          <- as.character(users$ID)
users
users             <- read_url_csv(onedrive_url.sep=";")
users             <- read_url_csv(onedrive_url,sep=";")
users$ID          <- as.character(users$ID)
users
users             <- read_url_csv(onedrive_url,";")
users$ID          <- as.character(users$ID)
users
users             <- read_url_csv(onedrive_url,... = list(sep=";"))
users$ID          <- as.character(users$ID)
users
read_url_csv <- function(url, ...){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- readr::read_csv(tmpFile, sep = ",")
return(url_csv)
}
read_url_csv <- function(url, sep = ","){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- readr::read_csv(tmpFile, sep = sep)
return(url_csv)
}
users             <- read_url_csv(onedrive_url,sep = ";")
users$ID          <- as.character(users$ID)
users
read_url_csv <- function(url, sep = ","){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- read.csv(tmpFile, sep = sep)
return(url_csv)
}
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ESjlRAy5mzVJh3LRucNvoTYBa5x7ReX2691dJ-5uwaob4w?download=1"
df <- read_url_csv(onedrive_url)
df
users             <- read_url_csv(onedrive_url,sep = ";")
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ES9Opw7qVkROh6yxmaC8ARQB1_RuzanE2l8fl3U7p6r4KQ?download=1"
users             <- read_url_csv(onedrive_url,sep = ";")
users$ID          <- as.character(users$ID)
users
library(readxl)
url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EaODUUKwdOFJtbyx6MQHshsBjMAYRqYYyXr-el08rDnpxQ?download=1"
destfile <- "regionais.xlsx"
curl::curl_download(url, destfile)
regionais <- read_excel(destfile,sheet = "Planilha1")
regionais
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
credentials[["mleal"]]
credentials[["mleal"]]$pass
credentials[["mleal"]]$pass == "mleal"
runApp()
#rm(list=ls())
library(shiny)
library(shinyWidgets)
library(shinydashboard)
library(dplyr)
library(readxl)
library(stringr)
library(flexdashboard)
library(ggplot2)
library(plotly)
library(rmarkdown)
library(pagedown)
library(stringr)
#library(rainy)
library(RODBC)
library(RMySQL)
library(RMariaDB)
#source(file = "funcoes.R",encoding = "UTF-8")
read_url_csv <- function(url, sep = ","){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- read.csv(tmpFile, sep = sep)
return(url_csv)
}
read_url_xlsx <- function(url,sheet = "Calendario"){
tmpFile <- tempfile()
download.file(url, destfile = tmpFile)
url_csv <- read_xlsx(path = tmpFile,sheet = sheet)
return(url_csv)
}
library(readxl)
url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EbsSsZPj4ntMvyRUG-0QYa4BTEQUCw8VXlCqTriyMQcYiw?download=1"
destfile <- "calendario.xlsx"
curl::curl_download(url, destfile)
calendario <- read_excel(destfile,sheet = "Calendario")
calendario         = calendario[c("Dia","Class Não Útil")]
colnames(calendario) <- c("Data","Dia_util")
calendario$Class_Dia <- is.na(calendario$Dia_util)
calendario$Data      <- as.Date(calendario$Data,format = "%d/%m/%Y")
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ESjlRAy5mzVJh3LRucNvoTYBa5x7ReX2691dJ-5uwaob4w?download=1"
df <- read_url_csv(onedrive_url)
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ES9Opw7qVkROh6yxmaC8ARQB1_RuzanE2l8fl3U7p6r4KQ?download=1"
users             <- read_url_csv(onedrive_url,sep = ";")
users$ID          <- as.character(users$ID)
library(readxl)
url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EaODUUKwdOFJtbyx6MQHshsBjMAYRqYYyXr-el08rDnpxQ?download=1"
destfile <- "regionais.xlsx"
curl::curl_download(url, destfile)
regionais <- read_excel(destfile,sheet = "Planilha1")
df                <- left_join(x = df,y = users,by=c("Pessoa reponsavel ID"="ID"),keep=TRUE,suffix = c("_LEADS","_users"))
names_df          <- c("ID","Tipo","Pipeline", "Fase do negocio","Negocio Recorrente","Negocio Repetido","Contato Fonte","Modificado por ID","Criado por","Pessoa reponsavel ID",
"Data prevista de fechamento","Data de inicio","Valor do emprestimo","Origem do Cliente","Data exportacao","Contato","Grupo de fase" ,
"Base","Produto Crefaz", "Fase automacao",  "Data negociar","Data analisar", "Data prospectar","Modificado em","Desafio","Desafio retencao"
)
colnames(df) <- names_df
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ES9Opw7qVkROh6yxmaC8ARQB1_RuzanE2l8fl3U7p6r4KQ?download=1"
users             <- read_url_csv(onedrive_url,sep = ";")
users$ID          <- as.character(users$ID)
library(readxl)
url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EaODUUKwdOFJtbyx6MQHshsBjMAYRqYYyXr-el08rDnpxQ?download=1"
destfile <- "regionais.xlsx"
curl::curl_download(url, destfile)
regionais <- read_excel(destfile,sheet = "Planilha1")
df                <- left_join(x = df,y = users,by=c("Pessoa reponsavel ID"="ID"),keep=TRUE,suffix = c("_LEADS","_users"))
df$`Pessoa reponsavel ID`          <- as.character(df$`Pessoa reponsavel ID` )
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/ES9Opw7qVkROh6yxmaC8ARQB1_RuzanE2l8fl3U7p6r4KQ?download=1"
users             <- read_url_csv(onedrive_url,sep = ";")
users$ID          <- as.character(users$ID)
library(readxl)
url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EaODUUKwdOFJtbyx6MQHshsBjMAYRqYYyXr-el08rDnpxQ?download=1"
destfile <- "regionais.xlsx"
curl::curl_download(url, destfile)
regionais <- read_excel(destfile,sheet = "Planilha1")
df                <- left_join(x = df,y = users,by=c("Pessoa reponsavel ID"="ID"),keep=TRUE,suffix = c("_LEADS","_users"))
df                <- left_join(x = df,y = regionais,by=c("Departamento"="Departamento"),keep=TRUE,suffix = c("_LEADS","_reg"))
colnames(df)[colnames(df) == "Departamento_reg"] <- "Lojas"
df                <- df %>% filter(str_detect(string = Lojas,pattern = "Loja CFZ"))
df                <- df %>% mutate("Fase do negocio" = ifelse(`Fase do negocio` == "PAGO AO CLIENTE","PAGO",`Fase do negocio`))
df                <- df %>% mutate("Fase do negocio" = ifelse(`Fase do negocio` == "EM ANÃ\u0081LISE","EM ANÁLISE",`Fase do negocio`))
df                <- df %>% mutate("Origem do Cliente"  = ifelse(`Origem do Cliente` == "" | is.na(`Origem do Cliente`) | `Origem do Cliente` == "NA"  ,"Não identificada",`Origem do Cliente`),
# "Fonte"              = ifelse(`Contato Fonte` =="",`Lead Fonte`,`Contato Fonte`),
"Origem do Cliente1" = ifelse(!is.na(`Contato Fonte`) ,"Fonte", `Origem do Cliente`),
"Data fechado"       = ifelse(`Fase do negocio` == "PAGO" | `Fase do negocio` == "DESAFIO",`Data prevista de fechamento`, NA),
"Data criado"        = ifelse(`Origem do Cliente1` == "Fonte" | `Origem do Cliente1` =="Não identificada",NA,`Data de inicio`))
#df$`Criado em`         <- as.Date(df$`Criado em`,format = "%d/%m/%Y")
df$`Data fechado`       <- lubridate::as_date(df$`Data fechado` , format = "%Y-%m-%d %H:%M:%S")
df$`Data analisar`      <- lubridate::as_date(df$`Data analisar`, format = "%Y-%m-%d %H:%M:%S")
df$`Data criado`        <- lubridate::as_date(df$`Data criado`, format = "%Y-%m-%d %H:%M:%S")
df$`Data negociar`      <- lubridate::as_date(df$`Data negociar`, format = "%Y-%m-%d %H:%M:%S")
df$`Data prospectar`    <- lubridate::as_date(df$`Data prospectar`, format = "%Y-%m-%d %H:%M:%S")
df$`Data de inicio`     <- lubridate::as_date(df$`Data de inicio`, format = "%Y-%m-%d %H:%M:%S")
df$`Modificado em`      <- lubridate::as_date(df$`Modificado em` , format = "%Y-%m-%d %H:%M:%S")
df$`Data de inicio` %>% range
df1 <- df
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(DT)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
stringr::str_detect(string = getwd(),pattern = "marco")
if( stringr::str_detect(string = getwd(),pattern = "marco")){
source(file = "librarys.R")
path_pg1 <- "pagina1.R"
path_pg2 <- "pagina1.R"
}else{
source(file = "librarys.R")
}
runApp()
shiny::runApp()
path_pg1 <-  source(file = "raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64RLNLRFP7YBFK6N3AQYQTCUYA",encoding = "UTF-8",local = F)
path_pg1 <-  source(file = "raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R",encoding = "UTF-8",local = F)
path_pg1 <-  source(file = "raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R",encoding = "UTF-8",local = F)
path_pg1 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64QLSLM4YNXHVQ6AFOSYQTCZTQ",encoding = "UTF-8",local = F)
path_pg1
runApp()
# path_pg1 <- "pagina1.R"
# path_pg2 <- "pagina2.R"
path_pg1 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64QLSLM4YNXHVQ6AFOSYQTCZTQ",encoding = "UTF-8",local = F,keep.source = TRUE)
path_pg1
source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64QLSLM4YNXHVQ6AFOSYQTCZTQ",encoding = "UTF-8",local = F,keep.source = TRUE)
# path_pg1 <- "pagina1.R"
# path_pg2 <- "pagina2.R"
path_pg1 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64QLSLM4YNXHVQ6AFOSYQTCZTQ",encoding = "UTF-8",local = F,keep.source = TRUE)
# path_pg1 <- "pagina1.R"
# path_pg2 <- "pagina2.R"
path_pg1 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64QLSLM4YNXHVQ6AFOSYQTCZTQ",encoding = "UTF-8",local = F,keep.source = TRUE)
# path_pg1 <- "pagina1.R"
# path_pg2 <- "pagina2.R"
path_pg1 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64QLSLM4YNXHVQ6AFOSYQTCZTQ",encoding = "UTF-8",local = F)
path_pg2 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina2.R?token=GHSAT0AAAAAABRYB64RZTD3ABUSHVXVEILAYQTC4IQ",encoding = "UTF-8",local = F)
# path_pg1 <- "pagina1.R"
# path_pg2 <- "pagina2.R"
path_pg1 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64QLSLM4YNXHVQ6AFOSYQTCZTQ",encoding = "UTF-8",local = F)
# path_pg1 <- "pagina1.R"
# path_pg2 <- "pagina2.R"
path_pg1 <-  source(file = "https://raw.githubusercontent.com/MarcoAVLeal/dash_mis/main/pagina1.R?token=GHSAT0AAAAAABRYB64RUKIOMLEFOPBEMPN6YQTDBCQ",encoding = "UTF-8",local = F)
path_pg1
runApp()
runApp()
runApp()
runApp()
path_pg1
runApp()
runApp()
shiny::runApp()
runApp()
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/Ea1IGOUCSa1Mjlev_QvrNLAB4I_qcKHjWy908-RxDbWPcQ?download=1"
x <- read_url_csv(onedrive_url)
#x <- read.csv(file = 'dados\\2022_02.csv')
output$msgbox_bitrix1 <- renderValueBox({
shinydashboard::valueBox(subtitle = tags$p("TOTAL", style = "font-size:100%;color:#E4781C;font-weight:bold;"),
value =tags$p(x[1,"total"], style = "font-size:50%;color:#E4781C;font-weight:bold") ,
width = 4, color = "navy")
})
x
runApp()
shiny::runApp()
runApp()
