scale_color_manual(values = c("darkgreen", "darkred","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_lines(size = 1.2, alpha = 0.75,aes(colour  = Legenda))+
scale_color_manual(values = c("darkgreen", "darkred","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(colour  = Legenda))+
scale_color_manual(values = c("darkgreen", "darkred","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(colour  = Legenda,group = 3))+
scale_color_manual(values = c("darkgreen", "darkred","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(colour  = Legenda,group = "Legenda"))+
scale_color_manual(values = c("darkgreen", "darkred","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = "Legenda"))+
scale_color_manual(values = c("darkgreen", "darkred","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = Legenda))+
scale_color_manual(values = c("darkgreen", "darkred","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = Legenda))+
scale_color_manual(values = c("darkgreen", "red","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
shiny::runApp()
runApp()
runApp()
runApp()
df_melt <- x1 %>% reshape2::melt(id.vars = "dia",measure.vars = c("total","pending","sent"),value.name = "Envios",variable.name= "Legenda")
df_melt$Legenda <- as.character(df_melt$Legenda)
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = Legenda))+
scale_color_manual(values = c("darkgreen", "red","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
#                  yend = max(df_acumulado$maxbom)),color = "red",size=1.2) +
# geom_segment(aes(x = max(df_acumulado$cutoff),
#                  y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2,
#                  xend = max(df_acumulado$cutoff)+0.1,
#                  yend = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2),
#              arrow = arrow(length = unit(0.5, "cm")))+
# annotate(geom="text", x = df_acumulado$cutoff+0.15,
#          y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2, label=paste0("KS.: ",round(df_acumulado$max_diff,3),"\nCutoff:",df_acumulado$cutoff),
#          color="black")
#
ggplotly(p1) %>% layout(hovermode = TRUE, spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>NÚMERO DE CASOS</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>CIDADES</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T,height= 600) %>% config(displayModeBar = FALSE)
df_melt %>%
plot_ly(x=~dia, y=~Envios, type="scatter", mode="lines+marker", color=~Legenda) %>% layout(hovermode = TRUE, spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>NÚMERO DE CASOS</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>CIDADES</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T,height= 600) %>% config(displayModeBar = FALSE)
names <- c("total","pending","sent")
names
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(i in names){
p <- add_trace(p, x = "dia", y = i, mode = "lines")
}
p
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(i in names){
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker", color=~Legenda)
}
p
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker", color=~"Lengenda")
for(i in names){
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker", color=~"Lengenda")
}
p
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker", color=~"Legenda")
for(i in names){
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker", color=~"Legenda")
}
p
x1
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker")
for(i in names){
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker")
}
p
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(i in names){
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker")
}
p
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker",evaluate = TRUE)
for(i in names){
p <- add_trace(p, x = "dia", y = i, type="scatter", mode="lines+marker",evaluate = TRUE)
}
p
#
#
#
#                                                                                                         showgrid=TRUE),
#                                                                                            yaxis = list (title = "<b>CIDADES</b>",
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
my_lines <- list(
list(x=x1$dia, y=x1$total, color='red'),
list(x=x1$dia, y=x1$pending, color='blue'),
list(x=x1$dia, y=x1$sent, color='green')
)
#
#
#
#                                                                                                         showgrid=TRUE),
#                                                                                            yaxis = list (title = "<b>CIDADES</b>",
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
my_lines <- list(
list(x=x1$dia, y=x1$total, color='red'),
list(x=x1$dia, y=x1$pending, color='blue'),
list(x=x1$dia, y=x1$sent, color='green')
)
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]), type="scatter", mode="lines+marker",evaluate = TRUE)
}
p
#
#
#
#                                                                                                         showgrid=TRUE),
#                                                                                            yaxis = list (title = "<b>CIDADES</b>",
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
my_lines <- list(
list(x=x1$dia, y=x1$total, color='red',nome = "Total"),
list(x=x1$dia, y=x1$pending, color='blue',nome = "Pendente"),
list(x=x1$dia, y=x1$sent, color='green',nome = "Enviado")
)
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),names = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
}
p
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),name = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),name = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
}
p
#
#
#
#                                                                                                         showgrid=TRUE),
#                                                                                            yaxis = list (title = "<b>CIDADES</b>",
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
my_lines <- list(
list(x=x1$dia, y=x1$total, color='red',nome = "Total"),
list(x=x1$dia, y=x1$pending, color='blue',nome = "Pendente"),
list(x=x1$dia, y=x1$sent, color='green',nome = "Enviado")
)
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),name = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
}
p
p %>% layout(hovermode = TRUE, spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>Qntd. Envios</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>Dias</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T,height= 600) %>% config(displayModeBar = FALSE)
p %>% layout(hovermode = "x", spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>Qntd. Envios</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>Dias</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T,height= 600) %>% config(displayModeBar = FALSE)
library(dplyr)
library(ggplot2)
df_melt <- x1 %>% reshape2::melt(id.vars = "dia",measure.vars = c("total","pending","sent"),value.name = "Envios",variable.name= "Legenda")
df_melt$Legenda <- as.character(df_melt$Legenda)
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = Legenda))+
scale_color_manual(values = c("darkgreen", "red","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
df_melt <- x1 %>% reshape2::melt(id.vars = "dia",measure.vars = c("total","pending","sent"),value.name = "Envios",variable.name= "Legenda")
df_melt$Legenda <- as.character(df_melt$Legenda)
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = Legenda))+
scale_color_manual(values = c("darkgreen", "red","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1);p1
#                  yend = max(df_acumulado$maxbom)),color = "red",size=1.2) +
# geom_segment(aes(x = max(df_acumulado$cutoff),
#                  y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2,
#                  xend = max(df_acumulado$cutoff)+0.1,
#                  yend = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2),
#              arrow = arrow(length = unit(0.5, "cm")))+
# annotate(geom="text", x = df_acumulado$cutoff+0.15,
#          y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2, label=paste0("KS.: ",round(df_acumulado$max_diff,3),"\nCutoff:",df_acumulado$cutoff),
#          color="black")
#
ggplotly(p1) %>% layout(hovermode = "x", spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>Qntd. Envios</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>Dias</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T,height= 600) %>% config(displayModeBar = FALSE)
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = Legenda))+
scale_color_manual(values = c("darkgreen", "red","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1)
#                  yend = max(df_acumulado$maxbom)),color = "red",size=1.2) +
# geom_segment(aes(x = max(df_acumulado$cutoff),
#                  y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2,
#                  xend = max(df_acumulado$cutoff)+0.1,
#                  yend = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2),
#              arrow = arrow(length = unit(0.5, "cm")))+
# annotate(geom="text", x = df_acumulado$cutoff+0.15,
#          y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2, label=paste0("KS.: ",round(df_acumulado$max_diff,3),"\nCutoff:",df_acumulado$cutoff),
#          color="black")
#
ggplotly(p1) %>% layout(hovermode = "x", spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>Qntd. Envios</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>Dias</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T,height= 600) %>% config(displayModeBar = FALSE)
runApp()
runApp()
#                  yend = max(df_acumulado$maxbom)),color = "red",size=1.2) +
# geom_segment(aes(x = max(df_acumulado$cutoff),
#                  y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2,
#                  xend = max(df_acumulado$cutoff)+0.1,
#                  yend = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2),
#              arrow = arrow(length = unit(0.5, "cm")))+
# annotate(geom="text", x = df_acumulado$cutoff+0.15,
#          y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2, label=paste0("KS.: ",round(df_acumulado$max_diff,3),"\nCutoff:",df_acumulado$cutoff),
#          color="black")
#
ggplotly(p1) %>% layout(hovermode = "x", spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>Qntd. Envios</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>Dias</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T) %>% config(displayModeBar = FALSE)
runApp()
df_melt <- x1 %>% reshape2::melt(id.vars = "dia",measure.vars = c("total","pending","sent"),value.name = "Envios",variable.name= "Legenda")
#df_melt$Legenda <- as.character(df_melt$Legenda)
p1 <- ggplot(data = df_melt,aes(x= dia, y = Envios))+
geom_point(size = 1.2, alpha = 0.75)+
geom_line(size = 1.2, alpha = 0.75,aes(color  = Legenda,group = Legenda))+
scale_color_manual(values = c("darkgreen", "red","darkblue")) +
# scale_x_continuous(breaks = seq(0,1*input$cut_renda1,0.05*input$cut_renda1))
# scale_y_continuous(breaks = seq(0,1,0.1))+
axis.theme(title_size = 12,textsize = 12,pos_leg = "bottom",x.angle = 45,vjust = 1,hjust=1)
p1
#                  yend = max(df_acumulado$maxbom)),color = "red",size=1.2) +
# geom_segment(aes(x = max(df_acumulado$cutoff),
#                  y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2,
#                  xend = max(df_acumulado$cutoff)+0.1,
#                  yend = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2),
#              arrow = arrow(length = unit(0.5, "cm")))+
# annotate(geom="text", x = df_acumulado$cutoff+0.15,
#          y = max(df_acumulado$maxmau) + max(df_acumulado$max_diff)/2, label=paste0("KS.: ",round(df_acumulado$max_diff,3),"\nCutoff:",df_acumulado$cutoff),
#          color="black")
#
ggplotly(p1)       %>% layout(hovermode = "x", spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>Qntd. Envios</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>Dias</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T) %>% config(displayModeBar = FALSE)
df_melt <- x1 %>% reshape2::melt(id.vars = "dia",measure.vars = c("total","pending","sent"),value.name = "Envios",variable.name= "Legenda")
df_melt$Legenda <- as.character(df_melt$Legenda)
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
# my_lines <- list(
#   list(x=x1$dia, y=x1$total, color='red',nome = "Total"),
#   list(x=x1$dia, y=x1$pending, color='blue',nome = "Pendente"),
#   list(x=x1$dia, y=x1$sent, color='green',nome = "Enviado")
# )
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),name = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
}
p %>% layout(hovermode = "x", spikedistance =  -1,margin = c(0,0,0,10),
xaxis = list(title = "<b>Qntd. Envios</b>", showspikes = TRUE, titlefont = list(size = 24),
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor',  ticks = "outside",tickangle = -45,
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
yaxis = list (title = "<b>Dias</b>",
spikemode  = 'across', #toaxis, across, marker
spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
showgrid=TRUE),
autosize = T,height= 600) %>% config(displayModeBar = FALSE)
runApp()
######################################                            ###########################################################
###################################### Renderiznado Info Whatsapp ###########################################################
######################################                            ###########################################################
axis.theme <- function(x.angle = 0,vjust=0,hjust=0.5,pos_leg="top",textsize = 10,lengend_title_size = 10,lengend_text_size = 8,title_size = 16){
theme_bw()  +
theme(
axis.text.x = element_text(angle = x.angle,face = "bold",size = textsize,hjust=hjust, vjust=vjust),
axis.text.y = element_text(angle = 0,face = "bold",size = textsize),
legend.background = element_rect(fill = "transparent", colour = NA,size = 2),
panel.background = element_rect(fill = "transparent", colour = NA),
plot.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(colour = "black",size = textsize,face = "bold"),
axis.title.y = element_text(colour = "black",size = textsize,face = "bold"),
legend.title = element_text(colour = "black",size = lengend_title_size),
legend.position = pos_leg,
legend.text = element_text(colour = "black",size = lengend_text_size,face = "bold"),
panel.grid = element_line(linetype="dashed"),
panel.grid.major = element_line(colour = "gray"),
title =element_text(size=title_size, face='bold',hjust = 0.5),
plot.title = element_text(hjust = 0.5),
axis.title = element_text(color="#000000", face="bold", size=textsize,lineheight = 2))
}
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/Ea1IGOUCSa1Mjlev_QvrNLAB4I_qcKHjWy908-RxDbWPcQ?download=1"
x <- read_url_csv(onedrive_url)
onedrive_url <- "https://crefaz-my.sharepoint.com/:x:/g/personal/gestaodedados4_crefaz_onmicrosoft_com/EZYuY8kORyJIoTYUo9RwWMABYEkZTA2OXtxrUXnrLef9pQ?download=1"
x1 <- read_url_csv(onedrive_url)
x1
# library(dplyr)
# library(ggplot2)
df_melt <- x1 %>% reshape2::melt(id.vars = "dia",measure.vars = c("total","pending","sent"),value.name = "Envios",variable.name= "Legenda")
df_melt$Legenda <- as.character(df_melt$Legenda)
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
# my_lines <- list(
#   list(x=x1$dia, y=x1$total, color='red',nome = "Total"),
#   list(x=x1$dia, y=x1$pending, color='blue',nome = "Pendente"),
#   list(x=x1$dia, y=x1$sent, color='green',nome = "Enviado")
# )
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),name = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
}
library(shiny)
library(shinyWidgets)
library(shinydashboard)
library(shinydashboardPlus)
library(dplyr)
library(readxl)
library(stringr)
library(flexdashboard)
library(ggplot2)
library(plotly)
library(rmarkdown)
library(pagedown)
library(stringr)
library(RODBC)
library(RMySQL)
library(RMariaDB)
library(ggtext)
library(fresh)
library(shinyWidgets)
library(shinycssloaders)
library(DT)
library(reshape2)
library(plotly)
# library(dplyr)
# library(ggplot2)
df_melt <- x1 %>% reshape2::melt(id.vars = "dia",measure.vars = c("total","pending","sent"),value.name = "Envios",variable.name= "Legenda")
df_melt$Legenda <- as.character(df_melt$Legenda)
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
# my_lines <- list(
#   list(x=x1$dia, y=x1$total, color='red',nome = "Total"),
#   list(x=x1$dia, y=x1$pending, color='blue',nome = "Pendente"),
#   list(x=x1$dia, y=x1$sent, color='green',nome = "Enviado")
# )
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),name = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
}
p
#                                                                                                          spikemode  = 'across', #toaxis, across, marker
#                                                                                                          spikesnap = 'cursor', zeroline=FALSE,titlefont = list(size = 24),
#                                                                                                          showline=TRUE,tickfont = list(size = 24),fixedrange=TRUE,
#                                                                                                          showgrid=TRUE),
#                                                                                            autosize = T,height= 600) %>% config(displayModeBar = FALSE)
# my_lines <- list(
#   list(x=x1$dia, y=x1$total, color='red',nome = "Total"),
#   list(x=x1$dia, y=x1$pending, color='blue',nome = "Pendente"),
#   list(x=x1$dia, y=x1$sent, color='green',nome = "Enviado")
# )
p <- plot_ly(data = x1)
names <- c("total","pending","sent")
for(line in my_lines) {
p <- add_trace(p,  x=line[['x']],  y=line[['y']],marker=list(color=line[['color']]),name = line[['nome']], type="scatter", mode="lines+marker",evaluate = TRUE)
}
p
